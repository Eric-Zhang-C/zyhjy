<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
<meta name="referrer" content="no-referrer">
  <link rel="apple-touch-icon" sizes="180x180" href="/zyhjy/images/relativity128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/zyhjy/images/relativity32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/zyhjy/images/relativity16.png">
  <link rel="mask-icon" href="/zyhjy/images/logo.svg" color="#222">

<link rel="stylesheet" href="/zyhjy/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Comic Sans MS:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/zyhjy/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zyh-eric.gitee.io","root":"/zyhjy/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="èƒŒæ™¯  è®°å½•åœ¨åšLABæ—¶é‡åˆ°çš„é—®é¢˜ã€‚ OS: Mac  archlab 0. èƒŒæ™¯çŸ¥è¯†ï¼ˆæ¥æºäºCSAPPä¸­æ–‡ç‰ˆç¬¬4ç« ï¼‰  Architecture:(also ISA: instruction set architecture)  assembly(text representation)&#x2F;machine(byte-level) code  Microarchitecture: implement">
<meta property="og:type" content="article">
<meta property="og:title" content="CMU CSAPP LABæŒ‡å—">
<meta property="og:url" content="https://zyh-eric.gitee.io/zyhjy/2022/06/10/CMU-CSAPP-LAB%E6%8C%87%E5%8D%97/">
<meta property="og:site_name" content="ZYHJY">
<meta property="og:description" content="èƒŒæ™¯  è®°å½•åœ¨åšLABæ—¶é‡åˆ°çš„é—®é¢˜ã€‚ OS: Mac  archlab 0. èƒŒæ™¯çŸ¥è¯†ï¼ˆæ¥æºäºCSAPPä¸­æ–‡ç‰ˆç¬¬4ç« ï¼‰  Architecture:(also ISA: instruction set architecture)  assembly(text representation)&#x2F;machine(byte-level) code  Microarchitecture: implement">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-10T14:56:50.000Z">
<meta property="article:modified_time" content="2023-07-30T10:15:18.561Z">
<meta property="article:author" content="Yuhang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zyh-eric.gitee.io/zyhjy/2022/06/10/CMU-CSAPP-LAB%E6%8C%87%E5%8D%97/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>CMU CSAPP LABæŒ‡å— | ZYHJY</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J17VP3T2B4"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-J17VP3T2B4');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/zyhjy/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ZYHJY</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/zyhjy/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/zyhjy/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/zyhjy/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/zyhjy/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/zyhjy/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zyh-eric.gitee.io/zyhjy/2022/06/10/CMU-CSAPP-LAB%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/zyhjy/images/zyhjy.png">
      <meta itemprop="name" content="Yuhang Zhang">
      <meta itemprop="description" content="çˆ±å°é›…ï¼Œçˆ±ç”Ÿæ´»ï¼Œçˆ±ç‰©ç†!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYHJY">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CMU CSAPP LABæŒ‡å—
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-06-10 22:56:50" itemprop="dateCreated datePublished" datetime="2022-06-10T22:56:50+08:00">2022-06-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-07-30 18:15:18" itemprop="dateModified" datetime="2023-07-30T18:15:18+08:00">2023-07-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/zyhjy/categories/os/" itemprop="url" rel="index"><span itemprop="name">os</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>5.8k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>10 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="èƒŒæ™¯">èƒŒæ™¯</h1>
<ul>
<li>è®°å½•åœ¨åšLABæ—¶é‡åˆ°çš„é—®é¢˜ã€‚</li>
<li>OS: Mac</li>
</ul>
<h1 id="archlab">archlab</h1>
<h2 id="èƒŒæ™¯çŸ¥è¯†æ¥æºäºcsappä¸­æ–‡ç‰ˆç¬¬4ç« ">0.
èƒŒæ™¯çŸ¥è¯†ï¼ˆæ¥æºäºCSAPPä¸­æ–‡ç‰ˆç¬¬4ç« ï¼‰</h2>
<ul>
<li><p>Architecture:(also ISA: instruction set architecture)</p>
<ul>
<li>assembly(text representation)/machine(byte-level) code</li>
</ul></li>
<li><p>Microarchitecture: implement of Architecture</p>
<ul>
<li>cache sizes, core freq</li>
</ul></li>
<li><p>{.c, .h} -&gt; .i -&gt; .s -&gt; .o</p></li>
<li><p>éœ€é˜…è¯»å†…å®¹4.1</p></li>
<li><p>Y86-64çš„ç¨‹åºå‘˜å¯è§çŠ¶æ€:</p>
<ul>
<li>15 registers:
<ul>
<li>%rax, %rcx, %rdx, %rbx, %rsp(æ ˆæŒ‡é’ˆ), %rbp, %rsi, %rdi</li>
<li>%r8, ... %r14</li>
</ul></li>
<li>æ¡ä»¶ç :
<ul>
<li>ZF, SF, OF</li>
</ul></li>
<li>PC</li>
<li>å†…å­˜</li>
<li>Stat
<ul>
<li>AOK, HLT, ADR, INS</li>
</ul></li>
</ul></li>
<li><p>Y86-64çš„æŒ‡ä»¤:</p>
<ul>
<li>è§P246å›¾4-2</li>
</ul></li>
<li><p>æ±‡ç¼–å™¨ä¼ªæŒ‡ä»¤(assembler directives):</p>
<ul>
<li>.quad (4å­—(word),8å­—èŠ‚)</li>
<li>".rodata"ï¼šåªè¯»æ•°æ®æ®µã€‚constå…¨å±€å˜é‡ã€‚æ¯”å¦‚printfè¯­å¥ä¸­çš„æ ¼å¼ä¸²å’Œå¼€å…³ï¼ˆswitchï¼‰è¯­å¥çš„è·³è½¬è¡¨ã€‚</li>
<li>".data"ï¼šæ•°æ®æ®µã€‚å·²åˆå§‹åŒ–çš„éé›¶å…¨å±€å˜é‡å’Œé™æ€å˜é‡ã€‚å®ƒä¼šåœ¨mainå‡½æ•°ä¹‹å‰è¢«å¤„ç†ã€‚</li>
<li>".bss"ï¼šæœªåˆå§‹åŒ–ï¼ˆæˆ–åˆå€¼ä¸º0ï¼‰çš„å…¨å±€å˜é‡ã€‚å®ƒåœ¨ç›®æ ‡æ–‡ä»¶ä¸­ä¸å å®é™…çš„ç©ºé—´ï¼ˆä¸ä¿å­˜åœ¨binæ–‡ä»¶ä¸­ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚ç›®æ ‡æ–‡ä»¶æ ¼å¼åŒºåˆ†åˆå§‹åŒ–å’Œæœªåˆå§‹åŒ–å˜é‡æ˜¯ä¸ºäº†æé«˜ç©ºé—´æ•ˆç‡ã€‚å¯åŠ¨ä»£ç å®Œæˆä¸¤æ–¹é¢ï¼šâ‘ æœªåˆå§‹åŒ–å˜é‡çš„æ¸…0ã€‚â‘¡è®¾ç½®å·²åˆå§‹åŒ–å˜é‡çš„åˆå€¼ã€‚ä¿å­˜äº†BSSæ®µå’ŒCOMMONæ®µï¼ˆå­˜æ”¾æ³¨é‡Šï¼‰çš„å†…å®¹ã€‚
<ul>
<li>æ³¨é‡Šï¼šä¸ºäº†è®©å¯åŠ¨ä»£ç ç®€å•ï¼Œç¼–è¯‘é“¾æ¥å™¨ä¼šæŠŠå·²åˆå§‹åŒ–çš„å˜é‡æ”¾.dataæ®µï¼Œè¿™ä¸ªæ®µçš„æ˜ åƒï¼ˆåŒ…å«äº†å„ä¸ªå˜é‡çš„åˆå€¼ï¼‰ä¿å­˜åœ¨â€œåªè¯»æ•°æ®æ®µâ€ã€‚å¯åŠ¨ä»£ç å¤åˆ¶è¿™ä¸ªæ˜ åƒåˆ°
.data
æ®µï¼Œåˆå§‹åŒ–æ‰€æœ‰å˜é‡ã€‚åˆå§‹åŒ–ä¸º0çš„å˜é‡ä¿å­˜åœ¨bssæ®µï¼Œæœªåˆå§‹åŒ–å˜é‡ä¿å­˜åœ¨commonæ®µï¼Œé“¾æ¥æ—¶å†å°†å…¶æ”¾å…¥bssæ®µã€‚å¯åŠ¨ä»£ç è°ƒç”¨
memset æŠŠæ‰€æœ‰æœªåˆå§‹åŒ–å˜é‡æ¸…0ã€‚</li>
</ul></li>
<li>".symtab"ï¼šç¬¦å·è¡¨ã€‚å­˜æ”¾è¢«å®šä¹‰å’Œå¼•ç”¨çš„å‡½æ•°åŠå…¨å±€å˜é‡ã€‚æ¯ä¸ªå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åœ¨.symtabä¸­éƒ½æœ‰ä¸€å¼ ç¬¦å·è¡¨ã€‚ä¸ç¼–è¯‘å™¨ä¸­çš„ç¬¦å·è¡¨ä¸åŒï¼Œ.symtabä¸åŒ…å«å±€éƒ¨å˜é‡çš„è¡¨ç›®ã€‚ä¸ä¸€å®šè¦é€šè¿‡-gç¼–è¯‘ç¨‹åºï¼Œå¾—åˆ°ç¬¦å·è¡¨ä¿¡æ¯ã€‚</li>
</ul>
<p>https://www.jianshu.com/p/7ec425403779</p></li>
<li><p>x86-64:</p>
<ul>
<li>push: å‹å…¥åŸå§‹%rspå€¼å†-8</li>
<li>pop: å°†%rspç½®ä¸ºå–å‡ºçš„å€¼</li>
<li>å¯„å­˜å™¨ä¼ å‚é¡ºåº https://zhuanlan.zhihu.com/p/27339191</li>
</ul></li>
<li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/usr/include/tk.h:86:11: fatal error: &#x27;X11/Xlib.h&#x27; file not found</span><br></pre></td></tr></table></figure>
<p>å®‰è£…X11 Makefile -I/private/var/select/X11/include</p></li>
<li><p>valP : è®¡ç®—åçš„PCçš„å€¼</p></li>
<li><p>valA, valB: è¯‘ç é˜¶æ®µä»rA(srcA) rB(srcB)å–å‡ºçš„å€¼</p></li>
<li><p>CC:3ä¸ª</p></li>
<li><p>Cnd:ZF SF OF</p></li>
<li><p>valE : ALUè®¡ç®—å‡ºçš„, å†™å…¥dstE</p></li>
<li><p>valM: å†…å­˜ä¸­å–å‡ºçš„ï¼Œå†™å‡ºdstM</p></li>
</ul>
<h2 id="flexç¼–è¯‘å‡ºé”™">1. flexç¼–è¯‘å‡ºé”™</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flex yas-grammar.lex</span><br><span class="line">mv lex.yy.c yas-grammar.c</span><br><span class="line">gcc -O1 -c yas-grammar.c</span><br><span class="line">gcc -Wall -O1 -g yas-grammar.o yas.o isa.o -lfl -o yas</span><br><span class="line">ld: library not found for -lfl</span><br></pre></td></tr></table></figure>
<ul>
<li>åŸå› : trying to use flex on OS/X</li>
<li>è§£å†³æ–¹æ¡ˆ:
<ul>
<li>Try <code>-ll</code> instead of <code>-lfl</code></li>
<li>for more information look at <a
target="_blank" rel="noopener" href="https://stackoverflow.com/questions/21298097/library-not-found-for-lfl">this</a></li>
</ul></li>
</ul>
<p>Task #1 - Extendible Hash Table unordered buckets insert/delete
key/value entries without specifying the max size of the table not need
shrink support checking</p>
<p>å“ˆå¸Œè¡¨çš„åŸç†å¦‚ä¸‹
https://www.geeksforgeeks.org/extendible-hashing-dynamic-approach-to-dbms/</p>
<p>[Task #2] - LRU-K Replacement Policy
https://www.cs.cmu.edu/~natassa/courses/15-721/papers/p297-o_neil.pdf
https://blog.csdn.net/AntiO2/article/details/128439155</p>
<p>[Task #3] - Buffer Pool Manager Instance
https://zhuanlan.zhihu.com/p/593982056 the same Page object may contain
a different physical page throughout the life of the system</p>
<p>B+æ ‘æ˜¯ä¸€ç§Mè·¯æœç´¢æ ‘ï¼ˆå…¶ä¸­Mè¡¨ç¤ºèŠ‚ç‚¹çš„æœ€å¤§å­èŠ‚ç‚¹æ•°ï¼‰ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š â€¢
å®ƒæ˜¯å®Œå…¨å¹³è¡¡çš„ï¼ˆå³æ¯ä¸ªå¶èŠ‚ç‚¹éƒ½åœ¨åŒä¸€æ·±åº¦ï¼‰ã€‚ â€¢
é™¤æ ¹èŠ‚ç‚¹å¤–çš„æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹è‡³å°‘åŠæ»¡ï¼ˆM/2-1 &lt;= é”®æ•° &lt;= M-1ï¼‰ã€‚ â€¢
å…·æœ‰kä¸ªé”®çš„æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹éƒ½æœ‰k+1ä¸ªéç©ºå­èŠ‚ç‚¹ã€‚
B+æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸€ä¸ªé”®/å€¼å¯¹æ•°ç»„ã€‚è¿™äº›å¯¹ä¸­çš„é”®æ˜¯ä»ç´¢å¼•æ‰€åŸºäºçš„å±æ€§æ´¾ç”Ÿå‡ºæ¥çš„ã€‚å€¼å°†æ ¹æ®èŠ‚ç‚¹æ˜¯å†…éƒ¨èŠ‚ç‚¹è¿˜æ˜¯å¶èŠ‚ç‚¹è€Œå¼‚ã€‚å¯¹äºå†…éƒ¨èŠ‚ç‚¹ï¼Œå€¼æ•°ç»„å°†åŒ…å«æŒ‡å‘å…¶ä»–èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚å¶èŠ‚ç‚¹å€¼æœ‰ä¸¤ç§æ–¹æ³•ï¼šè®°å½•IDå’Œå…ƒç»„æ•°æ®ã€‚è®°å½•IDæ˜¯æŒ‡å‘å…ƒç»„ä½ç½®çš„æŒ‡é’ˆã€‚å…·æœ‰å…ƒç»„æ•°æ®çš„å¶èŠ‚ç‚¹åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­å­˜å‚¨å…ƒç»„çš„å®é™…å†…å®¹ã€‚
è™½ç„¶æŒ‰ç…§B+æ ‘çš„å®šä¹‰å¹¶ä¸éœ€è¦ï¼Œä½†å‡ ä¹æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°ç»„éƒ½æŒ‰é”®æ’åºã€‚
ä»æ¦‚å¿µä¸Šè®²ï¼Œå†…éƒ¨èŠ‚ç‚¹ä¸Šçš„é”®å¯ä»¥è¢«è®¤ä¸ºæ˜¯æŒ‡å—é’ˆã€‚å®ƒä»¬å¼•å¯¼æ ‘éå†ï¼Œä½†ä¸ä»£è¡¨å¶å­èŠ‚ç‚¹ä¸Šçš„é”®ï¼ˆå› æ­¤ä¹Ÿä¸ä»£è¡¨å®ƒä»¬çš„å€¼ï¼‰ã€‚è¿™æ„å‘³ç€æ‚¨å¯èƒ½åœ¨å†…éƒ¨èŠ‚ç‚¹ï¼ˆä½œä¸ºæŒ‡å—é’ˆï¼‰ä¸­æ‹¥æœ‰ä¸€ä¸ªåœ¨å¶å­èŠ‚ç‚¹ä¸Šæ‰¾ä¸åˆ°çš„é”®ã€‚å°½ç®¡å¿…é¡»æ³¨æ„åˆ°ï¼Œä¼ ç»Ÿä¸Šå†…éƒ¨èŠ‚ç‚¹åªæ‹¥æœ‰åœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜åœ¨çš„é”®ã€‚</p>
<p>B+Treeæ’å…¥å’Œåˆ é™¤æ“ä½œå¦‚ä¸‹ï¼š</p>
<p>B+Tree æ’å…¥æ–°æ¡ç›®çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>æ‰¾åˆ°æ­£ç¡®çš„å¶å­èŠ‚ç‚¹ Lã€‚ æŒ‰æ’åºé¡ºåºå°†æ–°æ¡ç›®æ·»åŠ åˆ° L ä¸­ï¼š â€¢ å¦‚æœ L
æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œåˆ™æ“ä½œå®Œæˆã€‚ â€¢ å¦åˆ™å°† L æ‹†åˆ†ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ L å’Œ
L2ã€‚å¹³å‡é‡æ–°åˆ†é…æ¡ç›®å¹¶å¤åˆ¶ä¸­é—´é”®ã€‚å°†æŒ‡å‘ L2 çš„ç´¢å¼•æ¡ç›®æ’å…¥ L çš„çˆ¶é¡¹ä¸­ã€‚
è¦æ‹†åˆ†å†…éƒ¨èŠ‚ç‚¹ï¼Œè¯·å¹³å‡é‡æ–°åˆ†é…æ¡ç›®ï¼Œä½†å°†ä¸­é—´é”®å‘ä¸Šæ¨ã€‚ const KeyType
&amp;key åˆ é™¤ï¼š
å½“æ’å…¥æ“ä½œä½¿å¾—æ ‘å˜å¾—è¿‡æ»¡æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶éœ€è¦æ‹†åˆ†å¶å­èŠ‚ç‚¹ï¼Œä½†å¦‚æœåˆ é™¤æ“ä½œå¯¼è‡´æ ‘çš„å¤§å°å°äºä¸€åŠï¼Œåˆ™å¿…é¡»åˆå¹¶ä»¥é‡æ–°å¹³è¡¡æ ‘ã€‚
æ‰¾åˆ°æ­£ç¡®çš„å¶å­èŠ‚ç‚¹Lã€‚ åˆ é™¤æ¡ç›®ï¼š â€¢ å¦‚æœLè‡³å°‘åŠæ»¡ï¼Œåˆ™æ“ä½œå®Œæˆã€‚ â€¢
å¦åˆ™ï¼Œæ‚¨å¯ä»¥å°è¯•é‡æ–°åˆ†é…ï¼Œä»å…„å¼ŸèŠ‚ç‚¹å€Ÿç”¨ã€‚ â€¢
å¦‚æœé‡æ–°åˆ†é…å¤±è´¥ï¼Œåˆ™åˆå¹¶Lå’Œå…„å¼ŸèŠ‚ç‚¹ã€‚
å¦‚æœå‘ç”Ÿåˆå¹¶ï¼Œåˆ™å¿…é¡»åˆ é™¤æŒ‡å‘Lçš„çˆ¶é¡¹ä¸­çš„æ¡ç›®ã€‚</p>
<ol type="1">
<li>ä»å³è¾¹å€Ÿ</li>
<li>å€Ÿä¸åˆ°çš„è¯ä»å³è¾¹æ‹¿æ‰€æœ‰</li>
<li>æ²¡æœ‰å³è¾¹çš„è¯ ä»å·¦è¾¹å€Ÿ</li>
<li>å·¦è¾¹å€Ÿä¸åˆ°çš„è¯ï¼Œè¢«å·¦è¾¹åƒ</li>
</ol>
<p>B+Treeå¶å­é¡µå­˜å‚¨æœ‰åºçš„mä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­é”®å’Œå€¼çš„æ•°é‡ç›¸åŒã€‚åœ¨å®ç°ä¸­ï¼Œå€¼åº”è¯¥åªæ˜¯ç”¨äºå®šä½å®é™…å…ƒç»„çš„64ä½è®°å½•IDï¼Œå‚è§src/include/common/rid.hä¸­å®šä¹‰çš„RIDç±»ã€‚å¶å­é¡µä¸å†…éƒ¨é¡µå…·æœ‰ç›¸åŒçš„é”®/å€¼å¯¹æ•°é™åˆ¶ï¼Œå¹¶ä¸”åº”éµå¾ªåˆå¹¶ã€é‡æ–°åˆ†é…å’Œæ‹†åˆ†çš„ç›¸åŒæ“ä½œã€‚</p>
<p>æ‚¨å¿…é¡»åœ¨æŒ‡å®šçš„æ–‡ä»¶ä¸­å®ç°B+Treeå†…éƒ¨é¡µã€‚æ‚¨åªå…è®¸ä¿®æ”¹å¤´æ–‡ä»¶(src/include/storage/page/b_plus_tree_leaf_page.h)åŠå…¶ç›¸åº”çš„æºæ–‡ä»¶(src/storage/page/b_plus_tree_leaf_page.cpp)ã€‚</p>
<p>é‡è¦æç¤ºï¼šå³ä½¿å¶å­é¡µå’Œå†…éƒ¨é¡µåŒ…å«ç›¸åŒç±»å‹çš„é”®ï¼Œå®ƒä»¬å¯èƒ½å…·æœ‰ä¸åŒç±»å‹çš„å€¼ï¼Œå› æ­¤å¶å­å’Œå†…éƒ¨é¡µçš„max_sizeå¯èƒ½ä¸åŒã€‚</p>
<p>æ¯ä¸ªB+Treeå¶å­/å†…éƒ¨é¡µå¯¹åº”äºç”±ç¼“å†²æ± è·å–çš„å†…å­˜é¡µ(å³æ•°æ®éƒ¨åˆ†)ã€‚å› æ­¤ï¼Œæ¯æ¬¡å°è¯•è¯»å–æˆ–å†™å…¥å¶å­/å†…éƒ¨é¡µæ—¶ï¼Œæ‚¨éƒ½éœ€è¦ä½¿ç”¨å…¶å”¯ä¸€çš„page_idä»ç¼“å†²æ± ä¸­è·å–é¡µé¢ï¼Œç„¶åé‡æ–°è§£é‡Šä¸ºå¶å­æˆ–å†…éƒ¨é¡µï¼Œå¹¶åœ¨ä»»ä½•å†™å…¥æˆ–è¯»å–æ“ä½œåå–æ¶ˆå›ºå®šé¡µé¢ã€‚</p>
<p>Task #2 - B+Tree Data Structure
B+æ ‘ç´¢å¼•åº”ä»…æ”¯æŒå”¯ä¸€é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ‚¨å°è¯•å°†å…·æœ‰é‡å¤é”®çš„é”®å€¼å¯¹æ’å…¥ç´¢å¼•æ—¶ï¼Œå®ƒä¸åº”æ‰§è¡Œæ’å…¥å¹¶è¿”å›falseã€‚å¦‚æœåˆ é™¤å¯¼è‡´æŸä¸ªé¡µé¢ä½äºå ç”¨é˜ˆå€¼ï¼Œåˆ™æ‚¨çš„B+æ ‘ç´¢å¼•è¿˜å¿…é¡»æ­£ç¡®æ‰§è¡Œåˆå¹¶æˆ–é‡æ–°åˆ†é…ï¼ˆåœ¨æ•™ç§‘ä¹¦ä¸­ç§°ä¸ºâ€œåˆå¹¶â€ï¼‰ã€‚</p>
<p>åœ¨ç¬¬ä¸€æ£€æŸ¥ç‚¹ä¸­ï¼Œæ‚¨çš„B+æ ‘ç´¢å¼•ä»…éœ€è¦æ”¯æŒæ’å…¥ï¼ˆInsertï¼ˆï¼‰ï¼‰ï¼Œç‚¹æœç´¢ï¼ˆGetValueï¼ˆï¼‰ï¼‰å’Œåˆ é™¤ï¼ˆDeleteï¼ˆï¼‰ï¼‰ã€‚å¦‚æœæ’å…¥è§¦å‘æ‹†åˆ†æ¡ä»¶ï¼ˆæ’å…¥åé”®/å€¼å¯¹æ•°ç­‰äºå¶èŠ‚ç‚¹çš„max_sizeï¼Œæ’å…¥å‰å­èŠ‚ç‚¹çš„æ•°é‡ç­‰äºå†…éƒ¨èŠ‚ç‚¹çš„max_sizeï¼‰ï¼Œåˆ™åº”æ­£ç¡®æ‰§è¡Œæ‹†åˆ†ã€‚ç”±äºä»»ä½•å†™æ“ä½œéƒ½å¯èƒ½å¯¼è‡´B+æ ‘ç´¢å¼•ä¸­çš„root_page_idæ›´æ”¹ï¼Œå› æ­¤æ‚¨æœ‰è´£ä»»åœ¨å¤´éƒ¨é¡µé¢ï¼ˆsrc/include/storage/page/header_page.hï¼‰ä¸­æ›´æ–°root_page_idã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿ç´¢å¼•åœ¨ç£ç›˜ä¸Šæ˜¯æŒä¹…çš„ã€‚åœ¨BPlusTreeç±»ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä¸ºæ‚¨å®ç°äº†ä¸€ä¸ªåä¸ºUpdateRootPageIdçš„å‡½æ•°ï¼›åªéœ€åœ¨B+Treeç´¢å¼•çš„root_page_idæ›´æ”¹æ—¶è°ƒç”¨æ­¤å‡½æ•°å³å¯ã€‚</p>
<p>åœ¨è¿™éƒ¨åˆ†ä¸­ï¼Œæ‚¨éœ€è¦æ›´æ–°æ‚¨åŸæ¥çš„å•çº¿ç¨‹ B+Tree
ç´¢å¼•ï¼Œä½¿å…¶èƒ½å¤Ÿæ”¯æŒå¹¶å‘æ“ä½œã€‚
æˆ‘ä»¬å°†ä½¿ç”¨è¯¾å ‚å’Œæ•™ç§‘ä¹¦ä¸­æè¿°çš„é—©é”æŠ“å–æŠ€æœ¯ã€‚
éå†ç´¢å¼•çš„çº¿ç¨‹å°†è·å–ç„¶åé‡Šæ”¾ B+Tree é¡µé¢ä¸Šçš„é—©é”ã€‚
å¦‚æœå­é¡µé¢è¢«è®¤ä¸ºæ˜¯â€œå®‰å…¨çš„â€ï¼Œåˆ™çº¿ç¨‹åªèƒ½é‡Šæ”¾çˆ¶é¡µé¢ä¸Šçš„é—©é”ã€‚
è¯·æ³¨æ„ï¼Œâ€œå®‰å…¨â€çš„å®šä¹‰å¯èƒ½ä¼šæ ¹æ®çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ“ä½œç±»å‹è€Œæœ‰æ‰€ä¸åŒï¼š</p>
<p>æœç´¢ï¼šä»æ ¹é¡µé¢å¼€å§‹ï¼ŒæŠ“å–å­é¡µé¢ä¸Šçš„è¯»å– (R)
é—©é”ï¼Œç„¶ååœ¨æ‚¨åˆ°è¾¾å­é¡µé¢åç«‹å³é‡Šæ”¾çˆ¶é¡µé¢ä¸Šçš„é—©é”ã€‚
æ’å…¥ï¼šä»æ ¹é¡µå¼€å§‹ï¼ŒæŠ“å–å­é¡µä¸Šçš„å†™ (W) é—©é”ã€‚
ä¸€æ—¦å­©å­è¢«é”ä¸Šï¼Œæ£€æŸ¥å®ƒæ˜¯å¦å®‰å…¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸æ˜¯æ»¡çš„ã€‚
å¦‚æœå­©å­æ˜¯å®‰å…¨çš„ï¼Œè§£é™¤å¯¹ç¥–å…ˆçš„æ‰€æœ‰é”å®šã€‚
åˆ é™¤ï¼šä»æ ¹é¡µå¼€å§‹ï¼ŒæŠ“å–å­é¡µä¸Šçš„å†™ (W) é—©é”ã€‚
ä¸€æ—¦å­©å­è¢«é”ä¸Šï¼Œæ£€æŸ¥å®ƒæ˜¯å¦å®‰å…¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè‡³å°‘è¦åŠæ»¡ã€‚
ï¼ˆæ³¨æ„ï¼šå¯¹äºæ ¹é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥ä¸åŒçš„æ ‡å‡†ï¼‰å¦‚æœå­©å­æ˜¯å®‰å…¨çš„ï¼Œé‡Šæ”¾å¯¹ç¥–å…ˆçš„æ‰€æœ‰é”ã€‚
é‡è¦æç¤ºï¼šæœ¬æ–‡ä»…æè¿°é—©é”æŠ“å–èƒŒåçš„åŸºæœ¬æ¦‚å¿µï¼Œåœ¨å¼€å§‹å®æ–½ä¹‹å‰ï¼Œè¯·å‚é˜…è®²åº§å’Œæ•™ç§‘ä¹¦ç¬¬
15.10 ç« ã€‚</p>
<p>è¿™æ®µæ–‡å­—æ˜¯å…³äºåœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å®ç°ç´¢å¼•çš„ç¬¬äºŒä¸ªç¼–ç¨‹é¡¹ç›®çš„è¯´æ˜ã€‚è¯¥é¡¹ç›®è¦æ±‚å®ç°ä¸€ä¸ªç´¢å¼•ï¼Œä»¥ä¾¿å¿«é€Ÿæ£€ç´¢æ•°æ®ï¼Œè€Œæ— éœ€åœ¨æ•°æ®åº“è¡¨ä¸­æœç´¢æ¯ä¸€è¡Œï¼Œä»è€Œä¸ºéšæœºæŸ¥æ‰¾å’Œæœ‰åºè®°å½•çš„é«˜æ•ˆè®¿é—®æä¾›åŸºç¡€ã€‚åœ¨å®ç°B+æ ‘åŠ¨æ€ç´¢å¼•ç»“æ„ä¹‹å‰ï¼Œæ‚¨éœ€è¦å®ç°B+æ ‘çˆ¶é¡µé¢ã€B+æ ‘å†…éƒ¨é¡µé¢å’ŒB+æ ‘å¶é¡µé¢ã€‚ç”±äºæ ‘ç»“æ„åŠ¨æ€å¢é•¿å’Œæ”¶ç¼©ï¼Œå› æ­¤æ‚¨éœ€è¦å¤„ç†æ‹†åˆ†å’Œåˆå¹¶çš„é€»è¾‘ã€‚æ­¤é¡¹ç›®ç”±ä»¥ä¸‹ä»»åŠ¡ç»„æˆï¼Œå¹¶ä¸”æœ‰ä¸¤ä¸ªæ£€æŸ¥ç‚¹ã€‚åœ¨å¼€å§‹æ­¤é¡¹ç›®ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²ä»å…¬å…±BusTub
repoæ‹‰å–äº†æœ€æ–°ä»£ç ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œæ­¤æ“ä½œï¼š<code>git pull public master</code>ã€‚</p>
<p>åœ¨å®ç°è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›é™åˆ¶å’Œå»ºè®®ã€‚ä¾‹å¦‚ï¼Œä¸å…è®¸ä½¿ç”¨å…¨å±€ä½œç”¨åŸŸé—©æ¥ä¿æŠ¤æ•°æ®ç»“æ„ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨æ“ä½œå®Œæˆåï¼Œæ‚¨ä¸èƒ½é”å®šæ•´ä¸ªç´¢å¼•å¹¶ä»…åœ¨æ“ä½œå®Œæˆæ—¶è§£é”é—©ã€‚æˆ‘ä»¬å°†è¯­æ³•å’Œæ‰‹åŠ¨æ£€æŸ¥ä»¥ç¡®ä¿æ‚¨æ­£åœ¨æ­£ç¡®è¿›è¡Œé—©æŠ“å–ã€‚æˆ‘ä»¬å·²ç»æä¾›äº†è¯»å†™é—©çš„å®ç°ï¼ˆsrc/include/common/rwlatch.hï¼‰ï¼Œå¹¶å·²åœ¨é¡µé¢å¤´æ–‡ä»¶ä¸‹æ·»åŠ äº†å¸®åŠ©ç¨‹åºå‡½æ•°ä»¥è·å–å’Œé‡Šæ”¾é—©ï¼ˆsrc/include/storage/page/page.hï¼‰ã€‚æˆ‘ä»¬ä¸ä¼šåœ¨B+Treeç´¢å¼•ä¸­æ·»åŠ ä»»ä½•å¼ºåˆ¶æ€§æ¥å£ã€‚åªè¦ä¿æŒæ‰€æœ‰åŸå§‹å…¬å…±æ¥å£ä¸å˜ä»¥è¿›è¡Œæµ‹è¯•ç›®çš„ï¼Œå°±å¯ä»¥åœ¨æ‚¨çš„å®ç°ä¸­æ·»åŠ ä»»ä½•å‡½æ•°ã€‚</p>
<p>æ­¤å¤–ï¼Œä¸è¦ä½¿ç”¨malloc/newæ¥åˆ†é…å¤§å—å†…å­˜ä»¥ç”¨äºæ ‘ã€‚å¦‚æœéœ€è¦ä¸ºæ ‘åˆ›å»ºæ–°èŠ‚ç‚¹æˆ–éœ€è¦ç¼“å†²åŒºè¿›è¡ŒæŸäº›æ“ä½œï¼Œåˆ™åº”ä½¿ç”¨ç¼“å†²æ± ã€‚
å¯¹äºæ­¤ä»»åŠ¡ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨åä¸ºtransactionï¼ˆsrc/include/concurrency/transaction.hï¼‰çš„ä¼ é€’æŒ‡é’ˆå‚æ•°ã€‚å®ƒæä¾›äº†å­˜å‚¨åœ¨éå†B+æ ‘æ—¶è·å–é—©çš„é¡µé¢ä»¥åŠå­˜å‚¨åœ¨Removeæ“ä½œæœŸé—´åˆ é™¤çš„é¡µé¢çš„æ–¹æ³•ã€‚æˆ‘ä»¬å»ºè®®æ‚¨ä»”ç»†æŸ¥çœ‹B+æ ‘ä¸­çš„FindLeafPageæ–¹æ³•ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¿®æ”¹å…ˆå‰çš„å®ç°ï¼ˆè¯·æ³¨æ„ï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´æ”¹æ­¤æ–¹æ³•çš„è¿”å›å€¼ï¼‰ï¼Œç„¶ååœ¨æ­¤ç‰¹å®šæ–¹æ³•ä¸­æ·»åŠ é—©æŠ“å–é€»è¾‘ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨ç¼“å†²æ± ç®¡ç†å™¨ä¸­FetchPage()çš„è¿”å›å€¼æ˜¯æŒ‡å‘Pageå®ä¾‹ï¼ˆsrc/include/storage/page/page.hï¼‰çš„æŒ‡é’ˆã€‚æ‚¨å¯ä»¥åœ¨Pageä¸ŠæŠ“å–é—©ï¼Œä½†ä¸èƒ½åœ¨B+TreeèŠ‚ç‚¹ä¸ŠæŠ“å–é—©ï¼ˆå†…éƒ¨èŠ‚ç‚¹æˆ–å¶èŠ‚ç‚¹å‡ä¸å¯ï¼‰ã€‚</p>
<p>å¸¸è§çš„é™·é˜± æ‚¨æœªåœ¨è¯¥é¡¹ç›®ä¸­æµ‹è¯•çº¿ç¨‹å®‰å…¨æ‰«æï¼ˆä¸ä¼šæµ‹è¯•å¹¶å‘è¿­ä»£å™¨æ“ä½œï¼‰ã€‚
ç„¶è€Œï¼Œæ­£ç¡®çš„å®ç°å°†è¦æ±‚å¶é¡µåœ¨æ— æ³•è·å–å…¶å…„å¼Ÿä¸Šçš„é—©é”æ—¶æŠ›å‡º std::exception
ä»¥é¿å…æ½œåœ¨çš„æ­»é”ã€‚ ä»”ç»†è€ƒè™‘ç¼“å†²æ± ç®¡ç†å™¨ç±»çš„ UnpinPage(page_id, is_dirty)
æ–¹æ³•å’Œé¡µé¢ç±»çš„ UnLock() æ–¹æ³•ä¹‹é—´çš„é¡ºåºå’Œå…³ç³»ã€‚
åœ¨ä»ç¼“å†²æ± ä¸­å–æ¶ˆå›ºå®šåŒä¸€é¡µä¹‹å‰ï¼Œæ‚¨å¿…é¡»é‡Šæ”¾è¯¥é¡µä¸Šçš„é—©é”ã€‚
å¦‚æœä½ æ­£ç¡®åœ°å®ç°å¹¶å‘ B+tree ç´¢å¼•ï¼Œé‚£ä¹ˆæ¯ä¸ªçº¿ç¨‹æ€»æ˜¯ä¼šä»æ ¹åˆ°åº•éƒ¨è·å–
latchã€‚ é‡Šæ”¾é—©é”æ—¶ï¼Œè¯·ç¡®ä¿éµå¾ªç›¸åŒçš„é¡ºåºï¼ˆä¹Ÿå°±æ˜¯ä»æ ¹éƒ¨åˆ°åº•éƒ¨ï¼‰ã€‚
ä¸€ç§æç«¯æƒ…å†µæ˜¯æ’å…¥å’Œåˆ é™¤æ—¶ï¼Œæˆå‘˜å˜é‡root_page_id
(src/include/storage/index/b_plus_tree.h)ä¹Ÿä¼šè¢«æ›´æ–°ã€‚
ä½ æœ‰è´£ä»»é˜²æ­¢è¿™ä¸ªå…±äº«å˜é‡çš„å¹¶å‘æ›´æ–°ï¼ˆæç¤ºï¼šåœ¨ B+
æ ‘ç´¢å¼•ä¸­æ·»åŠ ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ std::mutex æ¥ä¿æŠ¤è¿™ä¸ªå˜é‡ï¼‰</p>
<p>ç«äº‰åŸºå‡†
ä¸ºç¡®ä¿æ‚¨æ­£ç¡®å®æ–½é”æŠ“å–ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç«äº‰åŸºå‡†ä»æ‚¨çš„å®æ–½ä¸­æ”¶é›†ä¸€äº›å¯å‘å¼ï¼Œå¹¶æ ¹æ®å¯å‘å¼æ‰‹åŠ¨æ£€æŸ¥æ‚¨çš„ä»£ç ã€‚
Contention ratioæ˜¯B+æ ‘åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨æ—¶ä¸å•çº¿ç¨‹ç¯å¢ƒç›¸æ¯”çš„å‡é€Ÿã€‚
é€šå¸¸ï¼ŒGradescope ä¸Šçš„ç«äº‰æ¯”åº”åœ¨ [2.5, 3.5] èŒƒå›´å†…ã€‚ äº‰ç”¨ç‡ &lt; 2.5
é€šå¸¸æ„å‘³ç€ä½ çš„é”æŠ“å–æ˜¯ä¸æ­£ç¡®çš„ï¼ˆä¾‹å¦‚ï¼Œå¯èƒ½æŒæœ‰ä¸€äº›å…¨å±€é”ï¼ŒæŒæœ‰ä¸€äº›é”ä¸å¿…è¦çš„é•¿æ—¶é—´ï¼‰ï¼ŒTA
å°†æ‰‹åŠ¨å®¡æŸ¥ä½ çš„ä»£ç å¹¶åº”ç”¨æ­£ç¡®æ€§æ‰£é™¤ã€‚ äº‰ç”¨ç‡ &gt; 3.5
æ„å‘³ç€æ‚¨çš„å®æ–½ä¸­çš„é”äº‰ç”¨å¤ªé«˜ï¼Œå»ºè®®æ‚¨è°ƒæŸ¥æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚</p>
<ol type="1">
<li>æ£€æŸ¥æ‰€æœ‰çš„unpinä¸é¡µåˆ é™¤</li>
<li>åŠ é”ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°æŸä¸€ç¡®å®šçš„å¶å­èŠ‚ç‚¹ï¼› æ ¹èŠ‚ç‚¹æœ‰å•ç‹¬çš„é”
å¦‚æœå‘ç”Ÿåˆå¹¶ï¼Œéœ€è¦å°†å¦å¤–ä¸€ä¸ªå¶å­ç»“ç‚¹åŠå…¶è·¯å¾„åŠ é”</li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>Yuhang Zhang
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://zyh-eric.gitee.io/zyhjy/2022/06/10/CMU-CSAPP-LAB%E6%8C%87%E5%8D%97/" title="CMU CSAPP LABæŒ‡å—">https://zyh-eric.gitee.io/zyhjy/2022/06/10/CMU-CSAPP-LABæŒ‡å—/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/zyhjy/2022/06/10/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E8%AE%B0%E5%BD%95/" rel="prev" title="ç§‘å­¦ä¸Šç½‘è®°å½•">
      <i class="fa fa-chevron-left"></i> ç§‘å­¦ä¸Šç½‘è®°å½•
    </a></div>
      <div class="post-nav-item">
    <a href="/zyhjy/2022/06/21/cpp%E7%9A%84%E8%8B%A5%E5%B9%B2%E8%AF%AD%E6%B3%95/" rel="next" title="C++è‹¥å¹²è¯­æ³•">
      C++è‹¥å¹²è¯­æ³• <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81ODg3Ni8zNTMzOA=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-number">1.</span> <span class="nav-text">èƒŒæ™¯</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#archlab"><span class="nav-number">2.</span> <span class="nav-text">archlab</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%83%8C%E6%99%AF%E7%9F%A5%E8%AF%86%E6%9D%A5%E6%BA%90%E4%BA%8Ecsapp%E4%B8%AD%E6%96%87%E7%89%88%E7%AC%AC4%E7%AB%A0"><span class="nav-number">2.1.</span> <span class="nav-text">0.
èƒŒæ™¯çŸ¥è¯†ï¼ˆæ¥æºäºCSAPPä¸­æ–‡ç‰ˆç¬¬4ç« ï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flex%E7%BC%96%E8%AF%91%E5%87%BA%E9%94%99"><span class="nav-number">2.2.</span> <span class="nav-text">1. flexç¼–è¯‘å‡ºé”™</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yuhang Zhang"
      src="/zyhjy/images/zyhjy.png">
  <p class="site-author-name" itemprop="name">Yuhang Zhang</p>
  <div class="site-description" itemprop="description">çˆ±å°é›…ï¼Œçˆ±ç”Ÿæ´»ï¼Œçˆ±ç‰©ç†!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/zyhjy/archives/">
        
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/zyhjy/categories/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/zyhjy/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/zyhjy/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022 â€“ 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuhang Zhang</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">333k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">9:15</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/zyhjy/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>

<script src="/zyhjy/js/utils.js"></script>


<script src="/zyhjy/js/schemes/pisces.js"></script>


<script src="/zyhjy/js/next-boot.js"></script>




  




  
<script src="/zyhjy/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
