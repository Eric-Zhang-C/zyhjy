<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
<meta name="referrer" content="no-referrer">
  <link rel="apple-touch-icon" sizes="180x180" href="/zyhjy/images/relativity128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/zyhjy/images/relativity32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/zyhjy/images/relativity16.png">
  <link rel="mask-icon" href="/zyhjy/images/logo.svg" color="#222">

<link rel="stylesheet" href="/zyhjy/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Comic Sans MS:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/zyhjy/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/zyhjy/lib/pace/pace-theme-minimal.min.css">
  <script src="/zyhjy/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zyh-eric.gitee.io","root":"/zyhjy/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="基础问题 introduce yourself Good afternoon, my name is Zhang Yuhang. I am a Master&#39;s student majoring in Computer Science at Fudan University, Shanghai, China. I completed my undergraduate studies in Soft">
<meta property="og:type" content="article">
<meta property="og:title" content="Prepare for Citadel Interview">
<meta property="og:url" content="https://zyh-eric.gitee.io/zyhjy/2023/09/16/Prepare-for-Citadel-Interview/">
<meta property="og:site_name" content="ZYHJY">
<meta property="og:description" content="基础问题 introduce yourself Good afternoon, my name is Zhang Yuhang. I am a Master&#39;s student majoring in Computer Science at Fudan University, Shanghai, China. I completed my undergraduate studies in Soft">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-16T09:52:01.000Z">
<meta property="article:modified_time" content="2023-09-27T01:55:26.705Z">
<meta property="article:author" content="Yuhang Zhang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zyh-eric.gitee.io/zyhjy/2023/09/16/Prepare-for-Citadel-Interview/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Prepare for Citadel Interview | ZYHJY</title><meta name="robots" content="noindex">
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J17VP3T2B4"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-J17VP3T2B4');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/zyhjy/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ZYHJY</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/zyhjy/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/zyhjy/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/zyhjy/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/zyhjy/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/zyhjy/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-solutions">

    <a href="/zyhjy/solutions/" rel="section"><i class="fa fa-code fa-fw"></i>算法题解</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zyh-eric.gitee.io/zyhjy/2023/09/16/Prepare-for-Citadel-Interview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/zyhjy/images/zyhjy.png">
      <meta itemprop="name" content="Yuhang Zhang">
      <meta itemprop="description" content="爱小雅，爱生活，爱物理!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZYHJY">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Prepare for Citadel Interview
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-16 17:52:01" itemprop="dateCreated datePublished" datetime="2023-09-16T17:52:01+08:00">2023-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-09-27 09:55:26" itemprop="dateModified" datetime="2023-09-27T09:55:26+08:00">2023-09-27</time>
              </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>35k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>58 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="基础问题">基础问题</h1>
<h2 id="introduce-yourself">introduce yourself</h2>
<p>Good afternoon, my name is Zhang Yuhang. I am a Master's student
majoring in Computer Science at Fudan University, Shanghai, China. I
completed my undergraduate studies in Software Engineering at Shanghai
Jiao Tong University, Shanghai, China. Currently, I study at the
Parallel Processing Institute of Fudan University with a focus on
architecture simulators. Our goal is to develop a loosely coupled
architecture simulator, decoupling functional model from timing model to
enhance the performance of the simulator. Through this project, I have
gained a solid understanding of operating system and low-level hardware
architecture.</p>
<p>To be honest, compared to my peers, I am two years older. This is
because I worked at Huawei Company for two years after graduating from
my undergraduate school. This work experience has made me value my
current learning opportunity even more and has strengthened my
determination to strive and learn. From 2020 to 2022, I worked as a
Software Engineer at Automotive Business Unit of Huawei Company, where I
was responsible for developing communication middleware for in-vehicle
systems. This middleware was based on the AUTOSAR Data Distribution
Service protocol. I was in charge of developing and maintaining the
publish-subscribe model, where publishers send data to specific topics,
and subscribers receive data by subscribing to corresponding topics.
This experience allowed me to gain expertise in modern C++ and design
patterns.</p>
<p>While working at Huawei, I learned about Citadel Securities through
my colleagues. Citadel Securities emphasizes innovation and
technological application, encouraging collaboration among employees to
share knowledge and experiences in order to collectively solve complex
problems. I have always aspired to such a corporate culture and work
environment. Additionally, Citadel Securities promotes continuous
learning and development, providing training opportunities to enable
employees to stay competitive in the fast-paced financial market
environment, which greatly appeals to me. Therefore, I am excited to
participate in the interview for the SE internship position at Citadel
Securities.</p>
<p>## why citadel</p>
<p>"I participated in a campus event organized by Citadel Securities and
learned that their internship program is highly practical. The company
conducts a thorough assessment of interns' abilities and assigns tasks
that are both meaningful and feasible. The mentors there will provide
intern with a lot of guidance throughout the internship. I appreciate
the challenging and meaningful work offered there, and Citadel
Securities is also a gold sponsor of the Cpp conference, where I can
learn advanced industrial-level system implementations. Therefore, I
chose to apply for an internship at Citadel Securities."</p>
<h2 id="work-experience">work experience</h2>
<ul>
<li>Role: Repository Owner &amp; Module Designer DDS Decentralized
Communication Middleware
<ol type="1">
<li>Project Description: Develop communication middleware based on
AUTOSAR DDS protocol,Realizing 10+ QOS. Release reliable data
transmission libraries with high efficiency and low latency,to support
the whole ADS high-level services.</li>
<li>Responsibility: 1).Owner of the DCPS upper module.Main developer and
maintainer of released APls and DCPS related features. 3).Contribute to
development specificationbased on functional safety requirement.Improve
group coding quality.Share advanced C++ features and typical application
scenarios.</li>
<li>Self Achievements:DDS communication solution is accepted by ADS
dual-chip solutionused in all commercial projects. Implement several
core optimizations in whole module including tuning module’s memory
allocation,reducing CPU load,and latency.</li>
</ol></li>
</ul>
<hr />
<p>In DDS (Data Distribution Service), DCPS stands for Data-Centric
Publish-Subscribe. It's a component of DDS that provides the
publish-subscribe communication model, allowing different parts of a
distributed system to communicate by publishing and subscribing to
data.</p>
<p>Here's a brief explanation of the terms:</p>
<ul>
<li><p><strong>Data-Centric</strong>: DDS focuses on the data itself
rather than the underlying transport mechanisms or protocols. It
emphasizes the management and distribution of data between different
parts of a system.</p></li>
<li><p><strong>Publish-Subscribe</strong>: This is a messaging pattern
where senders (publishers) of messages don't need to know the specifics
of the receivers (subscribers), and vice versa. Publishers and
subscribers communicate through a middleware (in this case, DDS) that
takes care of routing messages to the correct destinations.</p></li>
<li><p><strong>DCPS in DDS</strong>: The Data-Centric Publish-Subscribe
component in DDS is responsible for implementing the publish-subscribe
mechanism. It manages the registration of publishers and subscribers,
the filtering and routing of data, and ensures that data is delivered
reliably and efficiently.</p></li>
</ul>
<p>In summary, DCPS in DDS provides the core functionality that enables
applications to communicate using a data-centric publish-subscribe
model. It's a key component of DDS middleware, which is often used in
complex, distributed systems where high performance and reliability are
critical requirements.</p>
<hr />
<ul>
<li>Role: Owner PLOG: low level communication introspection debugging
module
<ol type="1">
<li>Project Description: An introspection debugging module,based on
lock-free queue and share memory.Support our developers with new dummy
APls and binary tools for debugging and performance tuning.Record
latency detail from different views during the whole life-cycle of any
end-to-end messages,which would be helpful for further analysis.</li>
<li>Responsibility: Be in charge of the whole module
independently,including investigation,module design, implementation,
UT/ST self-validating, and deployment.</li>
<li>Achievements: PLOG is now used as a key tool for latency analysis
transmission optimization and performance tuning. It is widely used
within our department across groups. The whole lifetime latency overhead
of each message is limited to less than 20us(~15 log points) when the
PLOG is enabled.</li>
</ol></li>
</ul>
<hr />
<ul>
<li><p>Role: Owner ADS servitization framework,Service Orchestration
Manager Sub-module</p>
<ol type="1">
<li>Project Description:A sub-module of our new serverless
framework,managing all the states of hundreds of services, which are
deployed in several different hardware domains. Manage instances' states
and help our users to choose or switch to correct service instances and
detect failures. Use Unix domain Sockets and DDS to communicate through
our base libraries.</li>
<li>Responsibility: The owner of SOM. Be responsible for detailed
modules design,key features implementation. UT/ST self-validating design
and successful project release. Decoupled module development based on
design documentation.</li>
<li>Achievements: Successfully implementing this new framework from zero
to one as a core developer. Service backup switching takes less than 1ms
within same domainand less than 10ms across different domains.</li>
</ol>
<hr /></li>
</ul>
<h2 id="campus-project">campus project</h2>
<p>The project is a high-performance timing simulator developed based on
the QEMU and GEM5 simulator. It is a loosely-coupled, functional-driven
simulation scheme for full-system multicore simulation. QEMU is
responsible for emulating the functional aspects, collecting runtime
information, which is then passed to GEM5 for timing simulation after
removing its functional emulation part. The simulation performance is
improved by approximately 2.0x compared to native GEM5. My main tasks
are as follows:</p>
<ul>
<li>QEMU writes runtime information, such as instruction execution
sequences and addresses, size and addresses of stored data, and branch
predictions, into shared memory for GEM5 O3 CPU to utilize.</li>
</ul>
<p>FM runs ahead and provides instructions and data access information
to TM. TM then uses such information to simulate the detailed timing of
micro-architecture. The interaction between FM and TM is much simpler
and thus provides great flexibility to extend. Further, as FM and TM are
now loosely-coupled, it also opens the opportunity to parallelize FM and
TM to improve performance.</p>
<h2
id="describe-something-that-makes-you-want-to-work-for-citadel-securities">Describe
something that makes you want to work for Citadel Securities</h2>
<p><strong>Innovation Culture:</strong> Citadel Securities is known for
its culture of innovation. They continually push the boundaries of
technology to develop sophisticated trading strategies, algorithms, and
risk management systems. As a software engineer, I'm drawn to the
opportunity to work on groundbreaking projects that require creative
problem-solving.</p>
<h2 id="why-are-you-interested-in-this-role">Why are you interested in
this role?</h2>
<ol type="1">
<li><strong>Impact on Financial Markets:</strong> Working at Citadel
Securities means having a direct impact on the financial markets. The
software and systems will play a critical role in the efficiency and
stability of these markets,。</li>
<li><strong>Learning Opportunities:</strong> Citadel Securities offers
an environment where learning is encouraged and supported. Being part of
a team that includes some of the brightest minds in the industry would
provide me with unparalleled opportunities for personal and professional
growth.</li>
</ol>
<h2 id="why-masters">why master‘s</h2>
<p>After working for two years, I decided to pursue a graduate degree
for several reasons. Firstly, I believe that furthering my education
will provide me with a deeper understanding of my field and allow me to
specialize in areas that interest me the most. Additionally, obtaining a
master's degree will open up new career opportunities and potentially
lead to higher-level roles with greater responsibilities. Furthermore, I
am eager to engage in advanced research and contribute to the academic
community. Overall, pursuing a graduate degree aligns with my long-term
career goals and aspirations for personal and professional growth.</p>
<hr />
<h1 id="半开放题">半开放题</h1>
<h2
id="code-implement-thread-safe-hash-table-reader-writer-lock-on-each-entry-of-hash-table">code:
implement thread-safe hash table (reader-writer lock on each entry of
hash table)</h2>
<p>In the hash table, a vector is used to store multiple buckets, where
each bucket is essentially a linked list. Each node in the linked list
holds a pointer to a table entry. To achieve thread safety, another
vector is created to store corresponding read-write locks for each
bucket. Whenever accessing a specific bucket, the corresponding lock is
acquired to ensure protection.</p>
<p>Alternatively, each hash table entry has a corresponding read-write
lock, but this would entail managing a vast number of locks, incurring
significant performance overhead.</p>
<h3 id="follow-up-how-to-rehash-the-hash-table-with-lock">follow up: how
to rehash the hash table with lock</h3>
<p>First, allocate space for the new bucket array, which is twice the
size of the current one, along with corresponding locks. Sequentially
acquire read locks for each bucket in the old bucket array and do not
release them. Rehash the elements of each bucket in the old bucket array
into the new bucket array, modify the hash function, and destroy the old
buckets along with their corresponding locks.</p>
<h2 id="design-a-circular-buffer">design a circular buffer</h2>
<ol type="1">
<li><p>memory_order</p>
<p>memory_order_acquire：</p>
<ul>
<li>A load operation with this memory order performs the <em>acquire
operation</em> on the affected memory location: no reads or writes in
the current thread can be reordered before this load.</li>
</ul>
<p>memory_order_release：</p>
<ul>
<li>A store operation with this memory order performs the <em>release
operation</em>: no reads or writes in the current thread can be
reordered after this store.</li>
</ul></li>
<li><p>lock-free queue</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*单写单读*/</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="type">size_t</span> Capsize&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">swsr</span> : <span class="keyword">private</span> allocator&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    T* data;</span><br><span class="line">    atomic&lt;<span class="type">size_t</span>&gt; head&#123;<span class="number">0</span>&#125;, tail&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">swsr</span>() : <span class="built_in">data</span>(allocator&lt;T&gt;::<span class="built_in">allocate</span>(Capsize)) &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function">    <span class="type">bool</span> <span class="title">push</span><span class="params">(Args&amp;&amp;... val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">size_t</span> t = tail.<span class="built_in">load</span>(memory_order_relaxed);</span><br><span class="line">        <span class="keyword">if</span>((t + <span class="number">1</span>) % Capsize == head.<span class="built_in">load</span>(memory_order_acquire))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        allocator&lt;T&gt;::<span class="built_in">construct</span>(data + t, std::forward&lt;Args&gt;(val)...);</span><br><span class="line">        tail.<span class="built_in">store</span>((t+<span class="number">1</span>) % Capsize, memory_order_release);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">pop</span><span class="params">(T &amp;val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">size_t</span> h = head.<span class="built_in">load</span>(memory_order_relaxed);</span><br><span class="line">        <span class="keyword">if</span>(h == tail.<span class="built_in">load</span>(memory_order_acquire))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        val = *(data + h);</span><br><span class="line">        <span class="comment">// destroy</span></span><br><span class="line">        head.<span class="built_in">store</span>((head + <span class="number">1</span>) % Capsize, memory_order_release);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*多写多读*/</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="type">size_t</span> Capsize&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">mwmr</span> : <span class="keyword">private</span> allocator&lt;T&gt;</span><br><span class="line">&#123;</span><br><span class="line">	T* data;</span><br><span class="line">	atomic&lt;<span class="type">size_t</span>&gt; head&#123;<span class="number">0</span>&#125;, tail&#123;<span class="number">0</span>&#125;, writeIndex&#123;<span class="number">0</span>&#125;, readIndex&#123;<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">mwmr</span>() : <span class="built_in">data</span>(allocator&lt;T&gt;::<span class="built_in">allocate</span>(Capsize)) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">push</span><span class="params">(T &amp;val)</span> <span class="comment">/// push into tail</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="type">size_t</span> t, w;</span><br><span class="line">		<span class="keyword">do</span>&#123;</span><br><span class="line">			t = tail.<span class="built_in">load</span>(memory_order_relaxed);</span><br><span class="line">			<span class="keyword">if</span>((t + <span class="number">1</span>) % Capsize == readIndex.<span class="built_in">load</span>(memory_order_acquire))</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125; <span class="keyword">while</span> (!tail.<span class="built_in">compare_exchange_strong</span>(t, (t + <span class="number">1</span>) % Capsize, memory_order_release));</span><br><span class="line">		*(data + t) = std::forward&lt;T&gt;(val);</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			w = t;</span><br><span class="line">		&#125; <span class="keyword">while</span> (!writeIndex.<span class="built_in">compare_exchange_strong</span>(w, (w + <span class="number">1</span>) % Capsize, memory_order_release));</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">pop</span><span class="params">(T &amp;val)</span> <span class="comment">/// fetch from tail</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="type">size_t</span> h, r;</span><br><span class="line">		<span class="keyword">do</span>&#123;</span><br><span class="line">			h = head.<span class="built_in">load</span>(memory_order_relaxed);</span><br><span class="line">			<span class="keyword">if</span>(h == writeIndex.<span class="built_in">load</span>(memory_order_acquire))</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125; <span class="keyword">while</span> (!head.<span class="built_in">compare_exchange_strong</span>(h, (h + <span class="number">1</span>) % Capsize, memory_order_release));</span><br><span class="line">		val = *(data + h);</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			r = h;</span><br><span class="line">		&#125; <span class="keyword">while</span> (!readIndex.<span class="built_in">compare_exchange_strong</span>(r, (r + <span class="number">1</span>) % Capsize, memory_order_release));</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="order-book-matching-algorithm">order book matching
algorithm</h2>
<p>An order book matching algorithm is a fundamental component of a
financial exchange platform. It is responsible for matching buy and sell
orders for various financial instruments, such as stocks,
cryptocurrencies, or commodities. The primary goal of this algorithm is
to efficiently match incoming orders while maintaining fairness and
transparency in the trading process. Here is an overview of how an order
book matching algorithm typically works:</p>
<ol type="1">
<li><p><strong>Order Book Data Structure</strong>: The exchange
maintains an order book, which is a data structure that stores all open
buy and sell orders. It typically consists of two sides: the "bid" side
for buy orders and the "ask" side for sell orders. Each order in the
book contains information such as the order price, order quantity, and
the order's unique identifier.</p></li>
<li><p><strong>Incoming Orders</strong>: When a trader submits a new
order (either a buy or sell order), the exchange receives the order and
adds it to the respective side of the order book (bid or ask). The new
order is placed in the appropriate position based on its price and the
time it was received.</p></li>
<li><p><strong>Matching Process</strong>: The core of the matching
algorithm involves finding potential matches between buy and sell
orders. The algorithm compares the prices of incoming orders to
determine if there are any matching orders.</p>
<ul>
<li>For a buy order (bid), it will look for sell orders (asks) with
prices equal to or lower than the buy order's price.</li>
<li>For a sell order (ask), it will look for buy orders (bids) with
prices equal to or higher than the sell order's price.</li>
</ul></li>
<li><p><strong>Price-Time Priority</strong>: In many exchanges,
price-time priority is used, meaning that orders with the most
competitive prices get matched first. If multiple orders have the same
price, the algorithm follows a first-in-first-out (FIFO) rule, matching
the earliest order first.</p></li>
<li><p><strong>Partial Fills</strong>: Orders may not be entirely
matched at once. If the incoming order is larger than the available
orders on the opposite side, it will be partially filled, and the
remaining quantity will remain on the order book.</p></li>
<li><p><strong>Trade Execution</strong>: When a match is found, a trade
execution occurs, and the matching buy and sell orders are removed from
the order book. The trade details, including price, quantity, and trade
ID, are recorded and reported to both parties.</p></li>
<li><p><strong>Continuous Process</strong>: The matching algorithm
continuously processes incoming orders, looking for new matches. This
ensures that the order book reflects real-time market
conditions.</p></li>
<li><p><strong>Cancel and Modify Orders</strong>: Traders can also
cancel or modify their existing orders. Canceling an order removes it
from the order book, while modifying an order may change its price or
quantity.</p></li>
<li><p><strong>Monitoring and Surveillance</strong>: Exchanges typically
implement monitoring and surveillance systems to detect and prevent
manipulative trading practices and ensure market integrity.</p></li>
</ol>
<p>The efficiency and fairness of an order book matching algorithm are
critical to the success of a financial exchange. Different exchanges may
employ variations of this algorithm to meet their specific trading
requirements and regulatory obligations. Additionally, high-frequency
trading and complex order types add further complexity to matching
algorithms used in modern electronic exchanges.</p>
<p>Order book matching
algorithm（订单簿匹配算法）是用于股票市场、加密货币交易和其他金融市场的交易引擎中的核心组成部分之一。它负责匹配买方和卖方提交的订单，以确定交易的价格和数量。下面是对订单簿匹配算法的简要介绍：</p>
<p>订单簿是市场上待处理订单的列表，包括买入订单（Bid）和卖出订单（Ask）。买入订单包括希望以特定价格购买资产的投资者，而卖出订单包括希望以特定价格出售资产的投资者。订单簿匹配算法的任务是在这些订单之间找到匹配的订单，以便执行交易。</p>
<p>以下是订单簿匹配算法的一般工作流程：</p>
<ol type="1">
<li><p><strong>接收订单</strong>：首先，交易引擎接收到来自投资者的买入和卖出订单。每个订单包括价格和数量等信息。</p></li>
<li><p><strong>订单排序</strong>：订单通常按价格和时间的优先级进行排序。买入订单按价格从高到低排序，卖出订单按价格从低到高排序。在价格相同的情况下，较早提交的订单具有更高的优先级。</p></li>
<li><p><strong>匹配订单</strong>：一旦订单进入订单簿，交易引擎开始匹配订单。通常，它会尝试将买入订单的最高出价与卖出订单的最低要价进行匹配。如果有匹配，交易引擎会生成一个交易，包括交易价格和数量，并从订单簿中移除已匹配的订单。</p></li>
<li><p><strong>重复匹配</strong>：订单簿匹配算法会不断重复这个过程，直到没有更多匹配的订单或者直到订单被取消。</p></li>
<li><p><strong>处理剩余订单</strong>：如果有未匹配的订单剩下，它们可以留在订单簿中等待进一步的匹配，也可以由投资者随时取消。</p></li>
</ol>
<p>订单簿匹配算法的性能和效率对于金融市场至关重要。它需要考虑市场的高速交易和大量订单，以便在毫秒级时间内做出决策。一些高级的订单簿匹配算法还可以处理复杂的交易策略，如市价订单、限价订单、止损订单等。</p>
<p>总之，订单簿匹配算法是现代金融市场中不可或缺的组成部分，它确保了市场的公平、高效和流畅运行。不同的交易所和金融平台可能会使用不同的订单簿匹配算法来满足其特定需求和交易规则。</p>
<h2 id="process-a-list-of-stock-orders-efficiently.">Process a list of
stock orders efficiently.</h2>
<p>Processing a list of stock orders efficiently is crucial for a
financial institution or trading platform to provide timely and accurate
execution of trades. Below are steps and considerations for efficiently
processing a list of stock orders:</p>
<ol type="1">
<li><strong>Data Structure for Order Book</strong>:
<ul>
<li>Use an efficient data structure to store the order book. Binary
search trees, hash tables, or priority queues are commonly used.</li>
<li>Maintain separate order books for buy (bid) and sell (ask)
orders.</li>
</ul></li>
<li><strong>Batch Processing</strong>:
<ul>
<li>Group incoming orders into batches to reduce overhead. For example,
process orders received within a specific time interval together.</li>
<li>This reduces the number of iterations through the order book.</li>
</ul></li>
<li><strong>Price-Time Priority</strong>:
<ul>
<li>Follow a price-time priority rule when matching orders. Orders with
the most competitive prices should be matched first.</li>
<li>Use timestamps to track the order arrival time and maintain FIFO
(First-In-First-Out) order within the same price level.</li>
</ul></li>
<li><strong>Efficient Matching Algorithms</strong>:
<ul>
<li>Implement efficient algorithms for order matching. For example, use
binary search for price matching.</li>
<li>Optimize algorithms for the specific data structure used in the
order book.</li>
</ul></li>
<li><strong>Parallel Processing</strong>:
<ul>
<li>Consider parallel processing to increase throughput. Modern hardware
and multi-core CPUs can handle concurrent order processing
effectively.</li>
<li>Use threading or distributed computing frameworks for
parallelism.</li>
</ul></li>
<li><strong>Cancel and Modify Orders</strong>:
<ul>
<li>Allow traders to cancel or modify their orders. Implement efficient
data structures and algorithms for handling order cancellations and
modifications.</li>
</ul></li>
<li><strong>Order Validation</strong>:
<ul>
<li>Validate orders for correctness and sufficiency of funds before
processing.</li>
<li>Reject orders with insufficient funds or erroneous details.</li>
</ul></li>
<li><strong>Risk Management</strong>:
<ul>
<li>Implement risk management controls to prevent large market-moving
orders from causing disruptions.</li>
<li>Apply circuit breakers or limit order execution size for certain
situations.</li>
</ul></li>
<li><strong>Monitoring and Surveillance</strong>:
<ul>
<li>Continuously monitor order flow for unusual trading patterns or
potential market manipulation.</li>
<li>Implement surveillance algorithms to detect irregularities.</li>
</ul></li>
<li><strong>Error Handling</strong>:
<ul>
<li>Handle errors gracefully. If there are issues with an order, provide
clear error messages to traders.</li>
<li>Log and report errors for later analysis.</li>
</ul></li>
<li><strong>Real-Time Updates</strong>:
<ul>
<li>Provide real-time updates to traders on the status of their
orders.</li>
<li>Notify traders of filled, partially filled, or canceled orders.</li>
</ul></li>
<li><strong>Scalability</strong>:
<ul>
<li>Design the system to be scalable, capable of handling increasing
order volume without degradation in performance.</li>
<li>Use load balancing and clustering techniques if necessary.</li>
</ul></li>
<li><strong>Testing and Simulation</strong>:
<ul>
<li>Thoroughly test the order processing system with a variety of
scenarios, including extreme cases and failure scenarios.</li>
<li>Use simulation tools to assess the system's performance under
different market conditions.</li>
</ul></li>
<li><strong>Regulatory Compliance</strong>:
<ul>
<li>Ensure that the order processing system complies with relevant
financial regulations and reporting requirements.</li>
</ul></li>
<li><strong>Back-Up and Disaster Recovery</strong>:
<ul>
<li>Implement robust backup and disaster recovery strategies to ensure
system availability in case of failures.</li>
</ul></li>
</ol>
<p>Efficient order processing is essential for maintaining a competitive
edge in the financial markets while ensuring fairness, transparency, and
regulatory compliance. The specific implementation details may vary
depending on the trading platform's requirements and technology
stack.</p>
<p>如何高效处理股票订单列表：</p>
<ol type="1">
<li><p><strong>订单分类</strong>：首先，将订单列表按照不同的股票进行分类。这可以确保每支股票的订单都被单独处理，降低混乱的可能性。</p></li>
<li><p><strong>按订单类型排序</strong>：将每支股票的订单按照订单类型进行排序，例如市价订单、限价订单、止损订单等。这有助于确定订单的执行顺序。</p></li>
<li><p><strong>批量处理</strong>：对于相同类型的订单，尽量批量处理。这可以减少系统处理订单的频率，提高效率。例如，可以批量执行相同的市价订单。</p></li>
<li><p><strong>并行处理</strong>：如果系统支持并行处理，可以同时处理多个订单。这可以通过多线程或分布式系统来实现，提高处理速度。</p></li>
<li><p><strong>使用高性能数据结构</strong>：选择适用于订单处理的高性能数据结构，以便快速查找和更新订单信息。例如，使用散列表来存储订单。</p></li>
<li><p><strong>优化算法</strong>：使用高效的算法来执行订单匹配和撮合。一些订单簿匹配算法可以在毫秒级时间内处理大量订单。</p></li>
<li><p><strong>错误处理和回滚</strong>：实现适当的错误处理机制，以便在出现问题时可以回滚订单或采取必要的补救措施，确保交易的正确性和稳定性。</p></li>
<li><p><strong>监控和性能优化</strong>：定期监控订单处理性能，识别瓶颈并进行性能优化。这可以通过使用性能分析工具和日志来实现。</p></li>
<li><p><strong>持续改进</strong>：不断改进订单处理系统，以适应不断变化的市场需求和交易规则。随着市场的演变，系统也需要不断更新和升级。</p></li>
<li><p><strong>灾备和容错</strong>：确保订单处理系统具有灾备和容错性能，以防止意外的系统故障或网络中断影响订单处理。</p></li>
</ol>
<p>高效处理股票订单列表对于金融交易非常重要，因为它可以确保交易的及时性和准确性，同时提高交易效率。这需要综合考虑技术、算法和系统架构等因素。</p>
<h2 id="implement-code-for-a-avl-binary-tree">Implement code for a AVL
binary tree</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> data;</span><br><span class="line">    Node* left;</span><br><span class="line">    Node* right;</span><br><span class="line">    <span class="type">int</span> height;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Node</span>(<span class="type">int</span> value) : <span class="built_in">data</span>(value), <span class="built_in">left</span>(<span class="literal">nullptr</span>), <span class="built_in">right</span>(<span class="literal">nullptr</span>), <span class="built_in">height</span>(<span class="number">1</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AVLTree</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Node* root;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">height</span><span class="params">(Node* node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (node == <span class="literal">nullptr</span>) ? <span class="number">0</span> : node-&gt;height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">balanceFactor</span><span class="params">(Node* node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">height</span>(node-&gt;left) - <span class="built_in">height</span>(node-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Node* <span class="title">rotateRight</span><span class="params">(Node* y)</span> </span>&#123;</span><br><span class="line">        Node* x = y-&gt;left;</span><br><span class="line">        Node* T2 = x-&gt;right;</span><br><span class="line"></span><br><span class="line">        x-&gt;right = y;</span><br><span class="line">        y-&gt;left = T2;</span><br><span class="line"></span><br><span class="line">        y-&gt;height = <span class="number">1</span> + std::<span class="built_in">max</span>(<span class="built_in">height</span>(y-&gt;left), <span class="built_in">height</span>(y-&gt;right));</span><br><span class="line">        x-&gt;height = <span class="number">1</span> + std::<span class="built_in">max</span>(<span class="built_in">height</span>(x-&gt;left), <span class="built_in">height</span>(x-&gt;right));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Node* <span class="title">rotateLeft</span><span class="params">(Node* x)</span> </span>&#123;</span><br><span class="line">        Node* y = x-&gt;right;</span><br><span class="line">        Node* T2 = y-&gt;left;</span><br><span class="line"></span><br><span class="line">        y-&gt;left = x;</span><br><span class="line">        x-&gt;right = T2;</span><br><span class="line"></span><br><span class="line">        x-&gt;height = <span class="number">1</span> + std::<span class="built_in">max</span>(<span class="built_in">height</span>(x-&gt;left), <span class="built_in">height</span>(x-&gt;right));</span><br><span class="line">        y-&gt;height = <span class="number">1</span> + std::<span class="built_in">max</span>(<span class="built_in">height</span>(y-&gt;left), <span class="built_in">height</span>(y-&gt;right));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Node* <span class="title">insert</span><span class="params">(Node* node, <span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Node</span>(value);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (value &lt; node-&gt;data) &#123;</span><br><span class="line">            node-&gt;left = <span class="built_in">insert</span>(node-&gt;left, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (value &gt; node-&gt;data) &#123;</span><br><span class="line">            node-&gt;right = <span class="built_in">insert</span>(node-&gt;right, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Duplicate values are not allowed.</span></span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        node-&gt;height = <span class="number">1</span> + std::<span class="built_in">max</span>(<span class="built_in">height</span>(node-&gt;left), <span class="built_in">height</span>(node-&gt;right));</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> balance = <span class="built_in">balanceFactor</span>(node);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Left-Left Case</span></span><br><span class="line">        <span class="keyword">if</span> (balance &gt; <span class="number">1</span> &amp;&amp; value &lt; node-&gt;left-&gt;data) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">rotateRight</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Right-Right Case</span></span><br><span class="line">        <span class="keyword">if</span> (balance &lt; <span class="number">-1</span> &amp;&amp; value &gt; node-&gt;right-&gt;data) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">rotateLeft</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Left-Right Case</span></span><br><span class="line">        <span class="keyword">if</span> (balance &gt; <span class="number">1</span> &amp;&amp; value &gt; node-&gt;left-&gt;data) &#123;</span><br><span class="line">            node-&gt;left = <span class="built_in">rotateLeft</span>(node-&gt;left);</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">rotateRight</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Right-Left Case</span></span><br><span class="line">        <span class="keyword">if</span> (balance &lt; <span class="number">-1</span> &amp;&amp; value &lt; node-&gt;right-&gt;data) &#123;</span><br><span class="line">            node-&gt;right = <span class="built_in">rotateRight</span>(node-&gt;right);</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">rotateLeft</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">inorderTraversal</span><span class="params">(Node* node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">inorderTraversal</span>(node-&gt;left);</span><br><span class="line">        std::cout &lt;&lt; node-&gt;data &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="built_in">inorderTraversal</span>(node-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">AVLTree</span>() : <span class="built_in">root</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> value)</span> </span>&#123;</span><br><span class="line">        root = <span class="built_in">insert</span>(root, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">inorder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">inorderTraversal</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    AVLTree avl;</span><br><span class="line">    avl.<span class="built_in">insert</span>(<span class="number">10</span>);</span><br><span class="line">    avl.<span class="built_in">insert</span>(<span class="number">20</span>);</span><br><span class="line">    avl.<span class="built_in">insert</span>(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Inorder Traversal of AVL Tree: &quot;</span>;</span><br><span class="line">    avl.<span class="built_in">inorder</span>();  <span class="comment">// Output: 10 20 30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="it-is-all-about-how-to-handle-a-string">It is all about how to
handle a string</h2>
<h3 id="stdstrings-at-member-method"><code>std::string</code>'s
<code>at</code> Member Method</h3>
<p>Similar to the indexing functionality, but without worrying about
out-of-range issues. It allows safe access to characters in the
string.</p>
<p>Since there is already an <code>at</code> method, why overload the
indexing operator?</p>
<p>This is primarily due to performance considerations. While
<code>at</code> ensures that it won't go beyond the string's range
(throwing an exception if it does), it is less efficient than the
indexing operation. It's a trade-off between safety and performance. To
ensure safety, you can use <code>at</code>; for performance, you can use
the indexing operation.</p>
<h3 id="small-string-optimization">Small String Optimization</h3>
<p>In C++, Small String Optimization (SSO) is a technique used by some
standard library implementations to optimize the storage of short
strings. This technique allows small strings to be stored directly
within the object, avoiding the need for dynamic memory allocation.</p>
<p>Here's a simplified explanation of how Small String Optimization
works in C++:</p>
<ol type="1">
<li><p><strong>Storage within the Object</strong>: When a string object
is created, a small internal buffer is reserved within the object
itself.</p></li>
<li><p><strong>Size Tracking</strong>: The string object keeps track of
its size and capacity. The capacity is the maximum number of characters
that can be stored in the internal buffer.</p></li>
<li><p><strong>Copying Small Strings</strong>: If the string being
assigned or constructed is small enough to fit within the internal
buffer, it is copied directly into that buffer. This avoids the need for
dynamic memory allocation.</p></li>
<li><p><strong>Dynamic Allocation for Larger Strings</strong>: If the
string is too large to fit in the internal buffer, dynamic memory
allocation is used to allocate memory on the heap to store the
string.</p></li>
<li><p><strong>Performance Benefits</strong>: Small String Optimization
can lead to significant performance improvements for short strings, as
it eliminates the overhead of dynamic memory allocation and deallocation
for common operations.</p></li>
</ol>
<p>我们可以看看GCC中<code>std::string</code>的实现：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> typedef basic_string&lt;char&gt;    string;   </span><br><span class="line">_Alloc_hider    _M_dataplus;</span><br><span class="line">size_type        _M_string_length;</span><br><span class="line">enum &#123; _S_local_capacity = 15 / sizeof(_CharT) &#125;;</span><br><span class="line">union</span><br><span class="line">&#123;</span><br><span class="line">    _CharT           _M_local_buf[_S_local_capacity + 1];</span><br><span class="line">    size_type        _M_allocated_capacity;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这里的<code>_CharT</code>就是<code>char</code>，所以<code>_S_local_capacity</code>等于<code>15</code>。当字符串的长度小于等于<code>15</code>时，直接存在<code>_M_local_buf</code>中，而不需要在堆中申请内存。当字符串长度大于<code>15</code>时，在内存中申请一块内存，这块内存的起始地址保存在<code>_M_dataplus</code>中，这块内存的容量保存在<code>_M_allocated_capacity</code>
中，而字符串的真实长度保存在<code>_M_string_length</code>中。当向字符串中添加字符时，如果添加字符的长度大于
<code>_M_allocated_capacity - _M_string_length</code>，则需要<code>resize</code>，否则直接追加到<code>_M_dataplus</code>保存的内存块中即可。</p>
<h3 id="operator">operator+</h3>
<p>In fact, the implementation in GCC overrides the global functions
<code>operator+(const std::string&amp;, const char*)</code> and
<code>operator+(const char*, const std::string&amp;)</code> as well as
<code>operator+(const std::string&amp;, const std::string&amp;)</code>.</p>
<h3 id="expand">expand</h3>
<p>it will allocate memory for a size that is approximately 1.5 to 2
times the current capacity.</p>
<hr />
<h1 id="八股">八股</h1>
<h2
id="merge-sort-quick-sort-difference-when-should-use-quicksortmergesort-cases-that-one-is-better-than-the-other">merge
sort &amp; quick sort difference, when should use quicksort/mergesort
(cases that one is better than the other)</h2>
<p><strong>Merge Sort:</strong> 1. <strong>Stability:</strong> Merge
sort is a stable sorting algorithm, which means that equal elements
maintain their relative order after sorting. 2. <strong>Guaranteed
Performance:</strong> Merge sort has a consistent and guaranteed
worst-case time complexity of O(n log n) for sorting any input. It is
suitable for sorting large datasets and is often used in external
sorting (sorting data too large to fit in memory). 3.
<strong>Recursive:</strong> Merge sort is typically implemented using a
recursive approach, making it more suitable for linked lists and data
structures that can efficiently support random access.</p>
<p><strong>Quick Sort:</strong> 1. <strong>In-Place:</strong> Quick sort
is an in-place sorting algorithm, meaning it doesn't require additional
memory for sorting. This makes it more memory-efficient than merge sort,
which requires additional space for merging. 2. <strong>Average-Case
Performance:</strong> Quick sort has an average-case time complexity of
O(n log n), which makes it faster on average than merge sort for most
inputs. 3. <strong>Not Stable:</strong> Quick sort is not a stable
sorting algorithm, which means that equal elements may not maintain
their relative order after sorting.</p>
<p><strong>When to Use Quick Sort:</strong> - Use quick sort when you
need a sorting algorithm with good average-case performance and minimal
memory overhead. Quick sort is often faster in practice for small to
medium-sized datasets. - Quick sort is a good choice when stability is
not a concern, and you want an in-place sorting algorithm.</p>
<p><strong>When to Use Merge Sort:</strong> - Use merge sort when you
need a sorting algorithm with a guaranteed worst-case time complexity of
O(n log n). It is suitable for sorting large datasets where worst-case
performance matters. - Merge sort is a good choice when you need a
stable sorting algorithm, ensuring that equal elements retain their
original order. - It is also suitable for sorting linked lists
efficiently because of its divide-and-conquer nature.</p>
<p>In summary, the choice between merge sort and quick sort depends on
your specific requirements and constraints. Quick sort is often
preferred for its average-case performance and in-place nature, while
merge sort is chosen when you need guaranteed worst-case performance and
stability.</p>
<h2 id="find-time-offset-between-two-remote-computers">find time offset
between two remote computers</h2>
<ol type="1">
<li><p><strong>Using Network Protocols:</strong></p>
<ol type="a">
<li><strong>NTP (Network Time Protocol):</strong> The Network Time
Protocol is designed for time synchronization across networks. You can
use an NTP client on one of the computers to query an NTP server and
compare the times. For example:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -q remote-ntp-server</span><br></pre></td></tr></table></figure>
<p>Replace <code>remote-ntp-server</code> with the actual NTP server you
want to query.</p>
<h3 id="implement-protocol">implement protocol</h3></li>
<li><p><strong>Client-Server Setup:</strong></p>
<ul>
<li>One computer will act as the NTP client, and the other will act as
the NTP server.</li>
<li>The client sends a request to the server asking for the current
time.</li>
</ul></li>
<li><p><strong>Request and Response:</strong></p>
<ul>
<li>The client sends a request packet to the server. This request
typically includes a timestamp.</li>
<li>The server receives the request, records the server's timestamp
(when it received the request), and sends a response back to the
client.</li>
<li>The response packet includes the server's timestamp when it sent the
response.</li>
</ul></li>
<li><p><strong>Calculating Time Offset:</strong></p>
<ul>
<li>When the client receives the response, it records the client's
timestamp (when it received the response).</li>
<li>The time offset between the two computers can be calculated as the
difference between the server's timestamp (when it sent the response)
and the client's timestamp (when it received the response).</li>
</ul></li>
</ol>
<h2 id="vector-vs-list">vector vs list</h2>
<h3 id="vector迭代器失效">vector迭代器失效？</h3>
<p>迭代器失效主要有两种情况引起：1.插入数据。由于插入数据可能导致数据搬移（<code>size &gt; capacity</code>）,所以迭代器失效。2.删除数据。当使用<code>erase</code>删除数据时，被删除数据后面的数据依次向前移一位。这会导致被删除数据之后的迭代器失效。</p>
<h3
id="list和vector相比有哪些优势什么情况下使用list什么情况下使用vector"><code>list</code>和<code>vector</code>相比，有哪些优势？什么情况下使用<code>list</code>，什么情况下使用<code>vector</code>？</h3>
<p><code>list</code>在随机插入和删除数据不会导致数据的搬移。</p>
<p>所以在频繁的随机插入/删除的场景使用<code>list</code>，其他场景使用<code>vector</code>。</p>
<h3
id="stdsort和list成员函数sort有什么区别吗"><code>std::sort</code>和list成员函数<code>sort</code>有什么区别吗？</h3>
<p><code>std::sort</code> is part of the STL algorithms. It requires
containers with random access iterators, so it can only be used with
<code>vector</code> and <code>deque</code>.</p>
<p>The <code>sort</code> member function of the <code>list</code> is
used for sorting <code>list</code>, and its time complexity is
<code>O(N*logN)</code>.</p>
<h3 id="forward_list"><code>forward_list</code></h3>
<p><code>std::forward_list</code>是C++11引入的新容器之一。它的底层是单向链表，引入它的主要目的是为了达到手写链表的性能。同时节省了部分内存空间。（只有一根指针）</p>
<h3
id="遍历两个元素数目相同的vector和list哪个效率高">遍历两个元素数目相同的<code>vector</code>和<code>list</code>，哪个效率高？</h3>
<p>上因为<code>vector</code>底层采用数组存储数据，所以它的空间局部性更好，对缓存更友好（<code>Cache-friendly</code>），所以遍历<code>vector</code>的效率要高于遍历<code>list</code>。</p>
<h3 id="vector-resize-vs-reserve">vector resize vs reserve</h3>
<p><code>resize</code> is used to change the size (number of elements)
of the <code>vector</code>.</p>
<p><code>reserve</code> is used to allocate memory for the
<code>vector</code> without changing its size.</p>
<h3 id="vector-push_back和emplace_back有什么区别">vector
<code>push_back</code>和<code>emplace_back</code>有什么区别？</h3>
<ul>
<li><p><code>push_back</code> is used to add a copy or a move of the
provided element to the back of the container. It is less efficient than
<code>emplace_back</code> when constructing objects directly in the
container because of the extra copy or move operation.</p></li>
<li><p><code>emplace_back</code> is used to construct a new element
directly in the container using the provided arguments. It forwards the
arguments directly to the constructor of the element type.</p></li>
<li><p>emplace_back返回元素的引用，push_back返回类型为void</p></li>
</ul>
<h3 id="vector扩容">vector扩容</h3>
<p>如果对象移动noexceot，扩容的时候就是move；反之则是普通的copy构造</p>
<h3 id="vectorbool"><code>vector&lt;bool&gt;</code></h3>
<p>The implementation of <code>vector&lt;bool&gt;</code> is inconsistent
with the implementation of other containers. Each element is treated as
a bit rather than a byte of storage. This means that we cannot take the
address of each element (as eight elements might be stored within the
same byte).</p>
<h3 id="stdremove"><code>std::remove</code></h3>
<p><code>std::remove</code> 是 C++
标准库中的一个算法，用于从容器中移除指定值的所有元素。但它并不会真正删除这些元素，而是将它们移到容器的末尾，并返回一个指向新逻辑末尾的迭代器。</p>
<h2 id="stack-vs-heap">stack vs heap</h2>
<p>In computer science and programming, "stack" and "heap" refer to two
different memory allocation mechanisms used to manage data and variables
in a program's memory. These mechanisms have distinct characteristics
and are used for different purposes.</p>
<p><strong>Stack:</strong></p>
<ol type="1">
<li><p><strong>Data Structure:</strong> The stack is a linear data
structure that operates in a last-in, first-out (LIFO) manner. This
means that the most recently added item is the first to be
removed.</p></li>
<li><p><strong>Memory Management:</strong> The stack is a region of
memory that is automatically managed by the program's runtime
environment, such as the operating system or a programming language
runtime.</p></li>
<li><p><strong>Usage:</strong> The stack is primarily used for storing
function call information, local variables, and managing the flow of
program execution. Each function call typically creates a new stack
frame with space for its local variables and function
parameters.</p></li>
<li><p><strong>Access Speed:</strong> Accessing data from the stack is
generally faster than the heap because it involves simple pointer
manipulation.</p></li>
<li><p><strong>Lifetime:</strong> Variables stored on the stack have a
relatively short lifetime. They are automatically deallocated when they
go out of scope or when a function returns.</p></li>
<li><p><strong>Size Limitation:</strong> The size of the stack is
usually limited, and attempting to allocate a large amount of data on
the stack can lead to a stack overflow error.</p></li>
</ol>
<p><strong>Heap:</strong></p>
<ol type="1">
<li><p><strong>Data Structure:</strong> The heap is a more complex data
structure that does not have a specific order or organization. It is a
region of memory where data is dynamically allocated and
deallocated.</p></li>
<li><p><strong>Memory Management:</strong> The heap is not managed
automatically by the program's runtime environment. Developers are
responsible for explicitly allocating and deallocating memory on the
heap using functions like <code>malloc</code> and <code>free</code> in
C/C++ or constructors and destructors in languages like C++.</p></li>
<li><p><strong>Usage:</strong> The heap is used for objects and data
with a longer lifetime or variable size requirements. It allows for
dynamic memory allocation and is often used for data structures like
linked lists, trees, and dynamic arrays.</p></li>
<li><p><strong>Access Speed:</strong> Accessing data from the heap is
generally slower than from the stack because it involves memory
allocation and deallocation and pointer dereferencing.</p></li>
<li><p><strong>Lifetime:</strong> Variables stored on the heap have a
longer lifetime and persist until explicitly deallocated. This makes it
suitable for managing data that needs to outlive the scope of a single
function or program.</p></li>
<li><p><strong>Size Limitation:</strong> The size of the heap is
typically limited by the available system memory, and it is possible to
allocate a large amount of data on the heap as long as there is enough
memory available.</p></li>
</ol>
<p>In summary, the choice between using the stack or heap depends on the
specific requirements of your program. The stack is suitable for
managing function call-related data and has a smaller, fixed size, while
the heap is used for dynamically allocated data with a longer lifetime
and variable size requirements. Proper management of memory on the heap
is essential to prevent memory leaks and other memory-related
issues.</p>
<h2 id="good-coding-manner-open-question">good coding manner (open
question)</h2>
<p>Good coding manners, also known as coding style or coding
conventions, are important for writing clean, maintainable, and readable
code. They make it easier for you and your team to understand and work
with code, reduce the likelihood of bugs, and contribute to the overall
professionalism of your software development efforts. Here are some key
principles of good coding style:</p>
<ol type="1">
<li><strong>Consistency:</strong> Consistency is crucial in coding
style. Stick to a set of conventions throughout your codebase. This
includes naming conventions, formatting, and indentation. If you're
working on a team, agree on and document coding standards. Descriptive
Variable and Function Names. Names should convey their purpose or
functionality.</li>
<li><strong>Modularization:</strong> Break your code into small, modular
functions or classes that have a single responsibility. This makes it
easier to understand, test, and maintain.</li>
<li><strong>Documentation:</strong> Write documentation for your code,
including high-level overviews and usage instructions for libraries or
APIs. Consider using tools like Doxygen, Sphinx, or Javadoc for
auto-generating documentation. <strong>Comments:</strong> Use comments
to explain complex logic, non-obvious decisions, and why something is
done a certain way. However, strive to write self-documenting code.
Well-named variables and functions can often eliminate the need for
comments.</li>
<li><strong>Code Reviews:</strong> Encourage code reviews within your
team to get feedback and improve code quality. Be open to constructive
criticism and learn from your peers.</li>
<li><strong>Performance:</strong> Write code that is efficient and
optimized when necessary. However, prioritize readability and
maintainability over premature optimization.</li>
</ol>
<h2 id="lock不能copy-所以怎么initialize">lock不能copy
所以怎么initialize?</h2>
<p><code>std::lock_guard</code> is a synchronization primitive that
simplifies the management of locks in a multithreaded C++ program. It is
typically used in conjunction with <code>std::mutex</code> or other
mutex types to provide automatic locking and unlocking of a mutex.</p>
<p><code>std::lock_guard</code> follows the <strong>RAII (Resource
Acquisition Is Initialization)</strong> principle</p>
<p><code>std::unique_lock</code>:Offers more flexibility and control
over mutex locking and unlocking.</p>
<p><code>std::unique_lock</code> 是一个包装器类，它可以与
<code>std::mutex</code> 或其他互斥量一起使用。你可以使用
<code>std::unique_lock</code> 对象来锁定和解锁
<code>std::mutex</code>，以便在访问共享资源时确保线程安全。</p>
<h2 id="virtual-functions-in-c">Virtual functions in C++</h2>
<p>In C++, virtual functions are implemented using a mechanism called
the virtual function table (vtable) and virtual function pointers.
Here's an explanation of how virtual functions work in C++:</p>
<ol type="1">
<li><p><strong>Class Declaration:</strong> When you declare a virtual
function in a C++ class, you indicate that this function can be
overridden by derived classes. You do this by using the
<code>virtual</code> keyword in the base class.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">virtualFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Base class implementation</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Virtual Function Table (vtable):</strong> When a class
contains one or more virtual functions, the compiler creates a virtual
function table (vtable) for that class. The vtable is a data structure
that contains pointers to the virtual functions of the class.</p></li>
<li><p><strong>Derived Classes:</strong> When a derived class inherits
from a base class with virtual functions and overrides those functions,
it provides its own implementations. These derived classes also have
their own vtables with pointers to the overridden virtual functions.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">virtualFunction</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Derived class implementation</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Dynamic Dispatch:</strong> When you call a virtual
function through a base class pointer or reference, the C++ runtime
system uses dynamic dispatch to determine which version of the function
to execute. It looks up the appropriate function pointer in the vtable
associated with the actual object's type, ensuring that the correct
derived class's implementation is called.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Base* ptr = <span class="keyword">new</span> <span class="built_in">Derived</span>();</span><br><span class="line">ptr-&gt;<span class="built_in">virtualFunction</span>(); <span class="comment">// Calls the Derived class&#x27;s implementation</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>Polymorphism:</strong> This mechanism enables
polymorphism in C++, where a single function call can have different
behaviors based on the actual type of the object at runtime.</p></li>
</ol>
<p>In summary, virtual functions in C++ are implemented using vtables
and virtual function pointers. They allow for runtime polymorphism,
enabling derived classes to provide their own implementations for base
class virtual functions, and the correct function to be called based on
the actual object's type during runtime.</p>
<h2 id="crtp">CRTP</h2>
<p><strong>Curiously Recurring Template Pattern (CRTP)</strong></p>
<p>This oddly named pattern refers to a general class of techniques that
consists of <strong>passing a derived class as a template argument to
one of its own base classes</strong>.</p>
<hr />
<h1 id="力扣题">力扣题</h1>
<p>rectangles overlap 没做过 写了个不是最优 但还凑合LC836✅</p>
<p>直接写next permutation + 写test + run LC31✅</p>
<p>find duplicate in a list✅hash</p>
<p>A quick way to factor prime numbers as part of the coding
challenge✅筛数法</p>
<p>sliding windows.</p>
<p>reverse a linked list ✅ dummy</p>
<p>Construct an acyclic graph from a list of edges✅BFS/DFS</p>
<p>How to in-place reverse string ✅ 双指针，swap</p>
<p>Find the maximum amount of money you can make if you buy and sell
stocks once in an array.✅dp</p>
<!-- flag of hidden posts -->
    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Yuhang Zhang
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://zyh-eric.gitee.io/zyhjy/2023/09/16/Prepare-for-Citadel-Interview/" title="Prepare for Citadel Interview">https://zyh-eric.gitee.io/zyhjy/2023/09/16/Prepare-for-Citadel-Interview/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC81ODg3Ni8zNTMzOA=="></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yuhang Zhang"
      src="/zyhjy/images/zyhjy.png">
  <p class="site-author-name" itemprop="name">Yuhang Zhang</p>
  <div class="site-description" itemprop="description">爱小雅，爱生活，爱物理!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/zyhjy/archives/">
        
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/zyhjy/categories/">
          
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/zyhjy/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/zyhjy/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuhang Zhang</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">439k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">12:11</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/zyhjy/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>

<script src="/zyhjy/js/utils.js"></script>


<script src="/zyhjy/js/schemes/pisces.js"></script>


<script src="/zyhjy/js/next-boot.js"></script>




  




  
<script src="/zyhjy/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
